
unless = args -> {
  open Shaper;
  match args {
    [ cond, body ] ->
      quote { if (not (unquote cond)) (unquote body) },
    _ -> failwith "unless: invalid args"
  };
};

do {
  open Fold;
  defmacro "unless" unless;
};